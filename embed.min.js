!function(){"use strict";var e,originalWidth,riddle2IntervalCheck,RiddleTrackNetworks=((e=RiddleTrackNetworks||{}).customTracking="customTracking",e.facebookPixel="facebookPixel",e.googleAnalytics="googleAnalytics",e.googleAnalytics4="googleAnalytics4",e.googleTagManager="googleTagManager",e.matomoTag="matomoTag",e);function AddLoader(e){e.wrapper.insertAdjacentHTML("beforeend",`<style>
            [${e.uuidAttr}] .rid-load {
                background: ${e.config.colorBackground};
            }
            [${e.uuidAttr}] .rid-load i {
                background: ${e.config.colorBackground};
            }
            [${e.uuidAttr}] .rid-load i:before {
                border-color: ${e.config.colorForeground};
            }
            .rid-load {
                padding-top: 56%;
                border-radius: 24px;
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                transition: opacity ease-out 0.5s;
                box-sizing: border-box;
            }
            .rid-load p {
                position: absolute;
                top: 50%;
                left: 50%;
                margin: -8px;
            }
            .rid-load i {
                position: absolute;
                display: block;
                width: 20px;
                height: 20px;
                border-radius: 5px;
                left: -8px;
                animation: 3s infinite rid-icon;
                transform: scale(1) rotate(30deg);
            }
            .rid-load i:before {
                box-sizing: border-box;
                content: '';
                display: block;
                position: absolute;
                left: 2px;
                right: 2px;
                bottom: 2px;
                top: 2px;
                border: 2px solid;
                border-radius: 3px;
            }
            .rid-load i+i {
                left: 0;
                top: -4px;
                transform: scale(1) rotate(45deg);
            }
            .rid-load i+i+i {
                left: 8px;
                top: 0;
                transform: scale(1) rotate(60deg);
            }
            @keyframes rid-icon {
                40% {
                    left:  0;
                    top: 0;
                    transform: scale(1) rotate(0);
                }
                60% {
                    left:  0;
                    top: 0;
                    transform: scale(1) rotate(0);
                }
            }
        </style>
        <div class="rid-load">
            <p><i></i><i></i><i></i></p>
        </div>`),e.wrapper.style.position="relative",e.wrapper.style.overflow="hidden",e.wrapper.style.transition="height ease-out 0.5s";let t=e.wrapper.getElementsByClassName("rid-load")[0];t&&(e.wrapper.style.height=t.getBoundingClientRect().height+"px",t.style.height="100%")}function RemoveLoader(e){let t=e.wrapper.getElementsByClassName("rid-load")[0];if(t){t.style.opacity="0",e.wrapper.style.height=e.iframe.getBoundingClientRect().height+"px";let i=setInterval(()=>{e.wrapper.style.height=e.iframe.getBoundingClientRect().height+"px"},10);setTimeout(()=>{clearInterval(i),e.wrapper.style.removeProperty("position"),e.wrapper.style.removeProperty("overflow"),e.wrapper.style.removeProperty("transition"),e.wrapper.style.removeProperty("height"),t.parentNode?.removeChild(t),e.wrapper.removeChild(e.wrapper.children[e.wrapper.children.length-1])},500)}}class Riddle2{id;uuidAttr;hasLoaded;wrapper;iframe;_isInFrameDetected=!1;_prevBodyOverflow="";config;constructor(e){e.classList.add("inited"),this.id=e.getAttribute("data-rid-id")||"",this.uuidAttr="data-riddle-v2-"+window.riddle2API.riddles.length,e.setAttribute(this.uuidAttr,""),this.hasLoaded=!1,this.wrapper=e,this.iframe=e.getElementsByTagName("iframe")[0],this.config={autoScroll:"false"!==e.getAttribute("data-auto-scroll"),autoScrollOffset:isNaN(parseInt(e.getAttribute("data-auto-scroll-offset")||""))?0:parseInt(e.getAttribute("data-auto-scroll-offset")||""),colorBackground:e.getAttribute("data-bg")||"#fff",colorForeground:e.getAttribute("data-fg")||"#00205b",isFixedHeightEnabled:"true"===e.getAttribute("data-is-fixed-height-enabled"),fixedHeight:e.getAttribute("data-fixed-height")||"650px"};var t=this.iframe.style;t.border="none",t.width="100%",t.position="absolute",t.opacity="0",AddLoader(this),this.sendMessage({isRiddleApi:!0,type:"requestRiddleStatus"})}sendMessage(e){this.iframe.contentWindow?.postMessage(e,"*")}InitComplete(){if(!this.hasLoaded){this.hasLoaded=!0;let e=this.iframe.style;e.opacity="1",e.position="static",this.config.isFixedHeightEnabled&&(e.height=this.config.fixedHeight),RemoveLoader(this)}}UpdateHeight(e){this.iframe.style.setProperty("height",e+"px","important"),void 0!==window.parent&&e>.95*document.documentElement.scrollHeight&&e<1.05*document.documentElement.scrollHeight&&1==window.riddle2API.riddles.length?this._isInFrameDetected||(this._isInFrameDetected=!0,this._prevBodyOverflow=document.body.style.overflow,document.body.style.overflow="hidden"):this._isInFrameDetected&&(this._isInFrameDetected=!1,document.body.style.overflow=this._prevBodyOverflow)}LazyLoad(e,t,i){let a=this.wrapper.getAttribute("data-embed-url");if(null!=e&&null!=t&&null!=i&&a&&this.iframe.src!=a&&!this.iframe.src.includes("riddle.com")){var r=e+this.wrapper.getBoundingClientRect().height,o=t<=e&&e<=i,l=t<=r&&r<=i;(o||l)&&(this.iframe.src=a)}}HideRiddle=()=>{this.wrapper.style.display="none"}}let validateDataLayerItem=(e,t)=>{let i=["string","number"],a=!0;return"object"!=typeof t&&(console.log("typeof DataLayerItem:",typeof t),console.log('DataLayerItem must be an object like: { key: "key", value: "value" || 0 }'),a=!1),"string"!=typeof t.key&&(console.log("typeof DataLayerItem.key:",typeof t.key),console.log('DataLayerItem must have a "key"'),a=!1),i.includes(typeof t.value)||(console.log("typeof DataLayerItem.value:",typeof t.value),console.log('DataLayerItem must have a "value" of type: '+i.join(" or ")),a=!1),a&&e.push(t),a};class DataLayer{constructor(){this.initDataLayer(),this.readFromUrl()}initDataLayer(){let e=[],t=window.riddleDataLayer;if(t){let i=!0;t.forEach(e=>{i&&(i=validateDataLayerItem([],e))}),i&&(e=JSON.parse(JSON.stringify(t)))}let a={set:this.setHandler};window.riddleDataLayer=new Proxy(e,a)}readFromUrl(){let e=window.location.search,t=new URLSearchParams(e),i=Object.fromEntries(t.entries());for(let a in i)if(Object.prototype.hasOwnProperty.call(i,a)){let r=i[a];this.push({key:a,value:r})}}push(e){if(window.riddleDataLayer){let t=window.riddleDataLayer.findIndex(t=>t.key===e.key);-1===t?window.riddleDataLayer.push(e):window.riddleDataLayer[t]=e}}notifyAll(){window.riddle2API.riddles.forEach(e=>{e.sendMessage({dataLayer:JSON.parse(JSON.stringify(window.riddleDataLayer)),riddleQueryString:window.location.href.split("?")[1],riddleParentLocation:window.location.href})})}notifyRiddle(e){e.sendMessage({dataLayer:JSON.parse(JSON.stringify(window.riddleDataLayer)),riddleQueryString:window.location.href.split("?")[1],riddleParentLocation:window.location.href})}setHandler(e,t,i){if("length"===t)return e[t]=i,!0;let a=validateDataLayerItem(e,i);return a&&window.riddle2API?.riddles.forEach(e=>{e.sendMessage({dataLayerItem:i})}),a}}let dataLayerInstance=window.riddle2API?.dataLayer;dataLayerInstance||(dataLayerInstance=new DataLayer),Object.freeze(dataLayerInstance);let dataLayerInstance$1=dataLayerInstance;function toggleFullScreen(e){var t=document.querySelectorAll('[data-rid-id="'+e+'"]'),i=t[0].getElementsByTagName("iframe")[0],a=document.getElementById("riddleFullScreenButton-"+e),r=document.body;null==originalWidth&&(originalWidth=t[0].style.width),!1==window.riddleAPI.isFullScreen?requestFullScreen(r,t[0],i,a):exitFullScreen(t[0],i,a)}function requestFullScreen(e,t,i,a){var r="";e.requestFullscreen?(e.requestFullscreen(),r="fullscreenchange"):e.msRequestFullscreen?(e.msRequestFullscreen(),r="MSFullscreenChange"):e.mozRequestFullScreen?(e.mozRequestFullScreen(),r="mozfullscreenchange"):e.webkitRequestFullScreen&&(e.webkitRequestFullScreen(),r="webkitfullscreenchange"),document.addEventListener(r,function(){fullscreenChange(t,i,a)})}function exitFullScreen(e,t,i){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),fullscreenChange(e,t,i)}function fullscreenChange(e,t,i){document.fullscreenEnabled||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement?(e.style.position="fixed",e.style.width="100%",e.style.top="0",e.style.left="0",e.style.background="#fff",e.style.setProperty("height","100%","important"),t.style.setProperty("height","100%","important"),i.style.position="fixed",i.style.bottom="20px",i.style.left="48%",window.riddleAPI.isFullScreen=!0):(e.style.position="static",e.style.top="0",e.style.left="0",e.style.width=originalWidth,e.style.setProperty("height","auto"),i.style.position="static",window.riddleAPI.isFullScreen=!1)}var scrollPosition$1=0;function sendPositionData(){for(var e=0;e<window.riddleAPI.riddles.length;e++){var t=window.riddleAPI.riddles[e].getElementsByTagName("iframe")[0],i=t.getBoundingClientRect().top+window.scrollY||window.pageYOffset,a=window.scrollY||window.pageYOffset,r=a+window.innerHeight;t.contentWindow.postMessage({iframeOffetTop:i,viewtop:a,viewbottom:r},"*"),checkIframe(i,a,r,t)}}function checkIframe(e,t,i,a){if(null!=e&&null!=t&&null!=i&&a.src!=a.parentElement?.getAttribute("data-embed-url")&&-1==a.src.indexOf("riddle.com")){var r=e+(a.parentElement?.getBoundingClientRect().height??0),o=t<=e&&e<=i,l=t<=r&&r<=i;(o||l)&&(a.src=a.parentElement?.getAttribute("data-embed-url")??"")}}function setScrollPosition(e){scrollPosition$1=e}function onWindowMessage$1(e){if("object"==typeof e.data)for(var t=0;t<window.riddleAPI.riddles.length;t++){var i=window.riddleAPI.riddles[t],a=i.getElementsByTagName("iframe")[0];if(e.source==a.contentWindow){if(e.data.riddleHeight){var r=a.style;if(window.riddleAPI.isFullScreen||r.setProperty("height",e.data.riddleHeight+"px","important"),0==r.opacity){r.opacity=1,r.position="static";for(var o=window.riddleAPI.riddles[t].getElementsByClassName("rid-load");o.length>0;)o[0].parentNode.removeChild(o[0])}null!=window.parent&&window.parent.postMessage({riddleHeight:e.data.riddleHeight+55,riddleId:e.data.riddleId},"*"),-1!=window.location.href.indexOf("?")&&postQueryStringToRiddle(i),postLocationHrefToRiddle(i),sendPositionData()}if(e.data.riddleEvent&&window.onRiddleEvent&&window.onRiddleEvent(e.data.riddleEvent,a),"page-change"!=e.data.riddleEvent||"false"==i.getAttribute("data-auto-scroll")||e.data.isUnrolledQuiz)"page-change"==e.data.riddleEvent&&"false"==i.getAttribute("data-auto-scroll")&&(preventSiteJump$1(),sendPositionData());else{var l=0;isNaN(i.getAttribute("data-auto-scroll-offset"))||(l=i.getAttribute("data-auto-scroll-offset")),a.scrollIntoView(!0),window.scrollBy(0,-10-l),sendPositionData()}if(e.data.riddleEvent&&"answer-poll"==e.data.riddleEvent.action&&"false"==i.getAttribute("data-auto-scroll")&&preventSiteJump$1(),null!=e.data.redirectToCustomLandingpagePath&&null!=e.data.redirectToCustomLandingpageData){var n=e.data.redirectToCustomLandingpagePath,d=e.data.redirectToCustomLandingpageData,s=window.parent.document.createElement("form");s.setAttribute("method","post"),s.setAttribute("action",n);var c=window.parent.document.createElement("input");c.setAttribute("type","hidden"),c.setAttribute("name","data"),c.setAttribute("value",d),s.appendChild(c),window.parent.document.body.appendChild(s),s.submit()}}}}function preventSiteJump$1(){var e=document.documentElement;setScrollPosition((window.pageYOffset||e.scrollTop)-(e.clientTop||0))}function postQueryStringToRiddle(e){e.getElementsByTagName("iframe")[0].contentWindow.postMessage({riddleQueryString:window.location.href.split("?")[1]},"*")}function postLocationHrefToRiddle(e){e.getElementsByTagName("iframe")[0].contentWindow.postMessage({riddleParentLocation:window.location.href},"*")}document.addEventListener("scroll",function(e){0!=scrollPosition$1&&(window.scrollTo(0,scrollPosition$1),scrollPosition$1=0),sendPositionData()}),window.riddleAPI||init();let riddleV1API=window.riddleAPI;function init(){window.riddleAPI={init:initRiddle$1,update:checkForNewRiddles$1,riddles:[],toggleFullScreen,isFullScreen:!1},window.addEventListener("message",onWindowMessage$1,!1),"loading"==document.readyState?document.addEventListener("DOMContentLoaded",checkForNewRiddles$1):checkForNewRiddles$1()}function checkForNewRiddles$1(){for(var e=document.body.querySelectorAll(".riddle_target");e.length;)initRiddle$1(e[0])}function initRiddle$1(e){if(!e.classList.contains("riddle-target-initialised")){e.className="riddle-target-initialised";var t="data-riddle-"+window.riddleAPI.riddles.length;e.setAttribute(t,"");var i=e.getElementsByTagName("iframe");if(0==i.length){var a=e.getAttribute("data-url")||e.getAttribute("data-game");if(!a)return;e.innerHTML+='<iframe src="'+a+'"></iframe>'}var r=i[0].style;if(r.border="none",r.width="100%",r.position="absolute",r.opacity="0",0==e.getElementsByClassName("rid-load").length){var o=e.getAttribute("data-fg")||"#1486cd",l=e.getAttribute("data-bg")||"#fff";e.insertAdjacentHTML("beforeend","<style>["+t+"] .rid-load {background: "+l+";}["+t+"] .rid-load i {background: "+o+';}.rid-load {border: 1px solid #cfcfcf!important;padding-top: 56%;border-radius: 5px;position: relative;}.rid-load p {position: absolute;top: 50%;left: 50%;margin: -8px}.rid-load i {position: absolute;width: 16px;height: 16px;border-radius: 3px;left: -25px;-webkit-animation: 1s infinite rid-icon;animation: 1s infinite rid-icon;-webkit-transform: scale(.4) rotate(62deg);transform: scale(.4) rotate(62deg);opacity: 0;}.rid-load i+i {-webkit-animation-delay: .17s;animation-delay: .17s;left: 0;}.rid-load i+i+i {-webkit-animation-delay: .34s;animation-delay: .34s;left: 25px;}@-webkit-keyframes rid-icon {50% {   opacity: 1;-webkit-transform: scale(1) rotate(62deg);}}@keyframes rid-icon {50% {opacity: 1;transform: scale(1) rotate(62deg);}}</style><div class="rid-load"><p><i></i><i></i><i></i></p></div>')}window.riddleAPI.riddles.push(e),sendPositionData()}}let riddle2API;function initAPI(){let e=dataLayerInstance$1;riddle2API=window.riddle2API={initRiddle,checkForNewRiddles,riddles:[],isFullScreen:!1,msgBacklog:[],isDOMReady:!1,dataLayer:e},window.addEventListener("message",onWindowMessage,!1),"loading"==document.readyState?document.addEventListener("DOMContentLoaded",()=>{riddle2API.isDOMReady=!0,checkForNewRiddles(),WorkMsgBacklog()}):(riddle2API.isDOMReady=!0,checkForNewRiddles())}function WorkMsgBacklog(){for(;riddle2API.msgBacklog.length>0;){let e=riddle2API.msgBacklog.splice(0,1)[0];onWindowMessage(e)}}function checkForNewRiddles(){clearTimeout(riddle2IntervalCheck);var e=document.body.querySelectorAll(".riddle2-wrapper, .riddle_target");for(let t of e)isRiddleV1(t.getAttribute("data-rid-id")??"")?riddleV1API.init(t):initRiddle(t);riddle2IntervalCheck=setTimeout(checkForNewRiddles,1e3)}function isRiddleV1(e){return/^[0-9]+$/.test(e)}function initRiddle(e){if(!e.classList.contains("inited")){let t=new Riddle2(e);riddle2API.riddles.push(t),sendPositionDataToIframes()}}function onWindowMessage(e){if("object"!=typeof e.data||!e.data.isRiddle2Event)return;let t=e.data,i=riddle2API.riddles.find(t=>e.source===t.iframe.contentWindow);if(i&&riddle2API.isDOMReady){if("string"==typeof e.data.category&&e.data.category.startsWith("RiddleTrackEvent")){let a=e.data;pushTrackEvent(a)}if(null!=window.parent){let r=JSON.parse(JSON.stringify(t));window.parent.postMessage(r,"*")}"RiddleInited"===t.type&&(i.InitComplete(),riddle2API.dataLayer?.notifyRiddle(i)),t.height&&!i.config.isFixedHeightEnabled&&i.UpdateHeight(t.height),t.hideRiddle&&i.HideRiddle(),e.data.riddle2Event&&window.onRiddle2Event&&window.onRiddle2Event(t,i.iframe),t.height&&sendPositionDataToIframes(),"Block_View"===e.data.action&&sendPositionDataToIframes();let o="Block_View_AnswerExplanation"===e.data.action&&e.data.blockOptions.answerExplanationOptions&&"Overlay"===e.data.blockOptions.answerExplanationOptions.position;if(i.config.autoScroll&&!t.isUnrolled&&"Block_View_AnswerExplanation"===e.data.action&&e.data.blockOptions.answerExplanationOptions&&"BelowAnswers"===e.data.blockOptions.answerExplanationOptions.position){let l=i.iframe.getBoundingClientRect().bottom+window.scrollY-window.innerHeight+10;window.scrollTo({top:l,behavior:"smooth"}),sendPositionDataToIframes()}else if(("PageChanged"==t.type||o||"Block_View"===e.data.action)&&i.config.autoScroll&&!t.isUnrolled){let n=i.iframe.getBoundingClientRect().top+window.scrollY-10-i.config.autoScrollOffset;window.scrollTo({top:n,behavior:"smooth"}),sendPositionDataToIframes()}else"PageChanged"!=t.type||i.config.autoScroll||(preventSiteJump(),sendPositionDataToIframes());if("AnswerPoll"!==t.type||i.config.autoScroll||preventSiteJump(),t.redirectToCustomLandingPage){let d=t.redirectToCustomLandingPage.path,s=t.redirectToCustomLandingPage.data,c=window.parent.document.createElement("form");c.setAttribute("method","post"),c.setAttribute("action",d);let g=window.parent.document.createElement("input");g.setAttribute("type","hidden"),g.setAttribute("name","data"),g.setAttribute("value",s),c.appendChild(g),window.parent.document.body.appendChild(c),c.submit()}}else riddle2API.msgBacklog.push(e)}window.riddle2API?riddle2API=window.riddle2API:initAPI();let scrollPosition=0;function sendPositionDataToIframes(){for(let e of riddle2API.riddles){var t=e.iframe.getBoundingClientRect().top+window.scrollY||window.pageYOffset,i=window.scrollY||window.pageYOffset,a=i+window.innerHeight;e.iframe.contentWindow?.postMessage({iframeOffsetTop:t,viewtop:i,viewbottom:a},"*"),e.LazyLoad(t,i,a)}}function preventSiteJump(){var e=document.documentElement;scrollPosition=(window.pageYOffset||e.scrollTop)-(e.clientTop||0)}function pushTrackEvent(riddleEvent){riddleEvent.trackNetworks&&riddleEvent.trackNetworks.forEach(trackNetwork=>{try{if(trackNetwork.networkName===RiddleTrackNetworks.customTracking){let tnef=trackNetwork.eventFunction,ef=eval(tnef);ef(riddleEvent)}else{let e=trackNetwork,t={...riddleEvent};switch(delete t.trackNetworks,trackNetwork.networkName){case RiddleTrackNetworks.facebookPixel:let i=window[e.networkObjectName];i("trackCustom",riddleEvent.category,{eventAction:riddleEvent.action,eventName:riddleEvent.name,...t});break;case RiddleTrackNetworks.googleAnalytics:let o=window[e.networkObjectName];o("send","event",[riddleEvent.category],[riddleEvent.action],[riddleEvent.name],...t);break;case RiddleTrackNetworks.googleAnalytics4:let a=window[e.networkObjectName];a("event",riddleEvent.category,{event_name:riddleEvent.name,event_action:riddleEvent.action,...t});break;case RiddleTrackNetworks.googleTagManager:window[e.networkObjectName].push({event:"RiddleEvent",event_category:riddleEvent.category,event_action:riddleEvent.action,event_name:riddleEvent.name,...t});break;case RiddleTrackNetworks.matomoTag:window[e.networkObjectName].push(["trackEvent",riddleEvent.category,riddleEvent.action,riddleEvent.name])}}}catch(e){console.log("[RiddleTrackingError] "+trackNetwork.networkName+" not found")}})}document.addEventListener("scroll",function(e){0!=scrollPosition&&(window.scrollTo(0,scrollPosition),scrollPosition=0),sendPositionDataToIframes()})}();
